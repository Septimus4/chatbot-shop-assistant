<div class="container my-5">

  <h1 class="mb-4 text-center">Chat #<%= @chat.id %></h1>

  <div class="chat-container card shadow mb-5">
    <div class="card-header bg-primary text-white">
      Chat History
    </div>
    <div class="card-body chat-body">

      <% if @messages.any? %>
        <% @messages.each do |message| %>
          <% is_user = message.sender_type.downcase == 'user' %>
          <div class="chat-message <%= is_user ? 'chat-message-user' : 'chat-message-bot' %>">
            <div class="chat-bubble">
              <div class="chat-sender <%= is_user ? 'text-success' : 'text-primary' %>">
                <%= message.sender_type.capitalize %>
              </div>
              <div class="chat-content">
                <%= simple_format(message.content) %>
              </div>
              <div class="chat-timestamp">
                <%= message.created_at.strftime("%Y-%m-%d %H:%M") %>
              </div>
            </div>
          </div>
        <% end %>
      <% else %>
        <p class="text-muted text-center my-4">No messages yet. Start the conversation!</p>
      <% end %>

    </div>
  </div>

  <div class="card shadow-sm mb-4">
    <div class="card-header">
      Send a New Message
    </div>
    <div class="card-body">
      <%= form_with model: [@chat, Message.new], local: true do |form| %>
        <div class="mb-3">
          <%= form.text_area :content, rows: 3, class: "form-control", placeholder: "Type your message..." %>
        </div>
        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
          <%= form.submit "Send Message", class: "btn btn-primary" %>
        </div>
      <% end %>
    </div>
  </div>

  <div class="text-center">
    <%= link_to "Back to Chats", chats_path, class: "btn btn-outline-secondary" %>
  </div>

</div>
